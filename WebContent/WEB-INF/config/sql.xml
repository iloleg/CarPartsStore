<?xml version="1.0" encoding="UTF-8"?>
<Queries>
	<UserManager>
		<Insert>
			INSERT INTO users (username, hash, role) VALUES (''{0}'', ''{1}'', (SELECT id FROM "userRoles" WHERE name = ''{2}''))
		</Insert>
		<DeleteByUsername>
			DELETE FROM users 
			WHERE username = ''{0}''
		</DeleteByUsername>
		<DeleteById>
			DELETE FROM users 
			WHERE id = {0} AND role = (SELECT id FROM "userRoles" WHERE name = ''User'')
		</DeleteById>
		<GetUser>
			SELECT users.id, username, hash, name AS role 
			FROM users INNER JOIN "userRoles" ON role = "userRoles".id WHERE username = ''{0}''
		</GetUser>
	</UserManager>
	
	<DataManager>
		<Insert>
			INSERT INTO parts (factory_id, brand, model, price) VALUES ({0}, ''{1}'', ''{2}'', {3})
		</Insert>
		<Update>
			UPDATE parts SET factory_id = {0}, brand = ''{1}'', model = ''{2}'', price = {3}
			WHERE id = {4}
		</Update>
		<DeleteById>
			DELETE FROM PARTS WHERE id = {0}
		</DeleteById>
		<ItemsCount>
			SELECT COUNT(*) FROM parts
		</ItemsCount>
		<UsersTable>
			SELECT users.id, username, name AS role 
			FROM users INNER JOIN "userRoles" ON role = "userRoles".id
		</UsersTable>
		<GetPage>
			SELECT id, factory_id, brand, model, price 
			FROM parts 
			ORDER BY id 
			LIMIT {0} 
			OFFSET {1}
		</GetPage>
		<GetPageSearch>
			SELECT id, factory_id, brand, model, price 
			FROM parts 
			WHERE CAST("{0}" AS TEXT) ILIKE ''{1}%'' 
			ORDER BY id 
			LIMIT {2} 
			OFFSET {3}
		</GetPageSearch>
	</DataManager>
</Queries>